# Excel文本批处理工具

这是一个基于Go语言开发的高性能Excel文本批处理工具，能够并发处理Excel文件中的文本数据，通过API进行智能处理，并将结果保存到新的Excel文件中。

## 功能特点

- 📝 支持Excel文件批量处理
- ⚡ 高性能并发处理（最多16个并发任务）
- 🔄 自动任务队列管理
- 📊 实时处理进度显示
- 📋 详细的日志记录
- 💾 自动备份处理结果

## 系统要求

- Go 1.16或更高版本
- 有效的API密钥

## 安装说明

1. 克隆项目到本地：
```bash
git clone [项目地址]
cd fuzhu_2
```

2. 安装依赖：
```bash
go mod download
```

## 使用方法

1. 准备输入文件
   - 创建名为`input.xlsx`的Excel文件
   - 在第一列中填入需要处理的文本内容

2. 配置API密钥
   - 在`main.go`中设置您的API密钥：
   ```go
   apiClient := api.NewAPIClient("your-api-key")
   ```

3. 运行程序
   ```bash
   go run main.go
   ```

4. 查看结果
   - 程序会在当前目录生成带时间戳的输出文件，格式为：`output_YYYY-MM-DD_HH-mm-ss.xlsx`
   - 处理日志保存在`logs`目录下

## 输出文件格式

输出的Excel文件包含两列：
- A列：原始输入文本
- B列：处理后的输出文本

## 日志系统

- 日志文件位置：`logs/YYYY-MM-DD_HH-mm-ss.log`
- 同时输出到控制台和日志文件
- 记录详细的处理进度和错误信息

## 性能优化

- 使用goroutine进行并发处理
- 默认最大并发数为16
- 使用channel控制并发数量
- 使用WaitGroup确保所有任务完成

## 错误处理

程序包含完善的错误处理机制：
- Excel文件操作错误处理
- API调用错误处理
- 并发处理错误处理
- 日志记录错误处理

## 项目结构

```
├── api/
│   └── client.go      # API客户端实现
├── types/
│   └── types.go       # 数据结构定义
├── utils/
│   ├── excel.go       # Excel处理功能
│   └── logger.go      # 日志系统实现
├── main.go            # 主程序入口
├── go.mod             # Go模块定义
└── README.md          # 项目文档
```

## 注意事项

1. 确保输入文件`input.xlsx`存在且格式正确
2. API密钥需要自行申请和配置
3. 处理大量数据时，注意API的调用限制
4. 建议定期备份输出文件

## 常见问题

1. 如果程序报错"打开Excel文件失败"：
   - 检查input.xlsx是否存在
   - 确保文件未被其他程序占用

2. 如果API调用失败：
   - 检查API密钥是否正确
   - 确认网络连接正常
   - 查看API调用限制是否超出

## 开发计划

- [ ] 支持更多文件格式
- [ ] 添加GUI界面
- [ ] 优化并发性能
- [ ] 添加更多API供应商支持
- [ ] 支持自定义处理规则

## 贡献指南

欢迎提交Issue和Pull Request来改进项目。在提交代码前，请确保：

1. 代码符合Go的代码规范
2. 添加了必要的测试用例
3. 更新了相关文档

## 许可证

[根据实际情况填写许可证信息]